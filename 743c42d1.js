import{c as e,_ as t,p as a,i,a as s,L as r,h as n}from"./5b7dc6e2.js";let o,p,d,l,c,m=e=>e,y=class extends r{constructor(){super(...arguments),this.teams=[]}render(){return n(o||(o=m` <ae-nav label="Setup battle" @nav-back="${0}"></ae-nav> <main> ${0} <ae-button data-type="fight" icon="fight" label="Fight" @click="${0}"></ae-button> </main> `),this.back,this.teams.map((e=>{const t=this.preferences.players.filter((t=>t.teamId===e.id));return t.length?n(p||(p=m` <div class="group"> <div class="team">Team ${0}</div> ${0} </div> `),e.id,t.map((e=>n(d||(d=m` <ae-player-card playerId="${0}" color="${0}" type="${0}" commander="${0}" money="${0}" unitLimit="${0}" @player-card-edit="${0}"></ae-player-card> `),e.id,e.color,e.type,e.commander,e.money,e.unitLimit,(()=>this.openPlayer(e)))))):n(l||(l=m``))})),this.openBattle)}async open(e){this.map=e||window.map,window.map=this.map,this.style.zIndex="1",this.preferences=await window.battleConfigurationService.preparePreferences(e.id),this.teams=[...Array(this.preferences.players.length)].map(((e,t)=>({id:t+1,label:"Team "+(t+1)})))}close(){this.style.zIndex="0"}openPlayer(e){const t=document.createElement("ae-dialog"),a=document.createElement("ae-player-preferences");a.player={...e},a.teamOptions=this.teams.map((e=>({value:e.id,label:e.label}))),a.addEventListener("player-preferences-submit",(e=>{this.updatePlayer(e.detail.value),t.close()})),t.append(a),document.body.append(t)}updatePlayer(e){this.preferences.players=this.preferences.players.map((t=>t.id===e.id?{...e}:t)),this.requestUpdate()}openBattle(){this.close();new window.BattleView(window.battleRepository,window.eventService,window.apiService,window.ai,window.soundService).open(),window.apiService.startMission(this.map.id,this.preferences)}back(){this.close();document.querySelector("ae-select-map").open()}};y.styles=e(c||(c=m`:host{display:block;position:fixed;top:0;left:0;width:100%;height:100%;background:#2e3851;box-sizing:border-box}main{display:grid;justify-items:center;overflow:auto}.group{margin:20px 0 0}ae-button{margin-top:50px}`)),t([a({type:Object})],y.prototype,"map",void 0),t([i()],y.prototype,"preferences",void 0),t([i()],y.prototype,"teams",void 0),y=t([s("ae-setup-map")],y);
