import{c as e}from"./d1ada6f5.js";import{c as t,_ as a,p as r,i,a as s,L as p,h as n}from"./5b7dc6e2.js";let o,d,l,c,m,h=e=>e,y=class extends p{constructor(){super(...arguments),this.teams=[]}render(){return n(o||(o=h` <ae-nav label="Setup battle" @nav-back="${0}"></ae-nav> <main> ${0} <ae-button data-type="fight" icon="fight" label="Fight" @click="${0}"></ae-button> </main> `),this.back,this.teams.map((e=>{const t=this.preferences.players.filter((t=>t.teamId===e.id));return t.length?n(d||(d=h` <div class="group"> <div class="team">Team ${0}</div> ${0} </div> `),e.id,t.map((e=>n(l||(l=h` <ae-player-card playerId="${0}" color="${0}" type="${0}" commander="${0}" money="${0}" unitLimit="${0}" @player-card-edit="${0}"></ae-player-card> `),e.id,e.color,e.type,e.commander,e.money,e.unitLimit,(()=>this.openPlayer(e)))))):n(c||(c=h``))})),this.openBattle)}async open(e){this.preferences=await window.battleConfigurationService.preparePreferences(this.mapId),this.teams=[...Array(this.preferences.players.length)].map(((e,t)=>({id:t+1,label:"Team "+(t+1)})))}openPlayer(e){const t=document.createElement("ae-dialog"),a=document.createElement("ae-player-preferences");a.player={...e},a.teamOptions=this.teams.map((e=>({value:e.id,label:e.label}))),a.addEventListener("player-preferences-submit",(e=>{this.updatePlayer(e.detail.value),t.close()})),t.append(a),document.body.append(t)}updatePlayer(e){this.preferences.players=this.preferences.players.map((t=>t.id===e.id?{...e}:t)),this.requestUpdate()}openBattle(){window.apiService.startMission(this.mapId,this.preferences),this.dispatchEvent(e("route-change",{route:"battle"}))}back(){this.dispatchEvent(e("route-change",{route:"skirmish"}))}};y.styles=t(m||(m=h`:host{display:block;position:fixed;top:0;left:0;width:100%;height:100%;background:#2e3851;box-sizing:border-box}main{display:grid;justify-items:center;overflow:auto}.group{margin:20px 0 0}ae-button{margin-top:50px}`)),a([r({type:String})],y.prototype,"mapId",void 0),a([i()],y.prototype,"preferences",void 0),a([i()],y.prototype,"teams",void 0),y=a([s("ae-setup-map")],y);
