import{c as e}from"./d1ada6f5.js";import{c as t,_ as o,p as n,q as i,a,L as r,h as s}from"./5b7dc6e2.js";let p,d,l=e=>e,c=class extends r{constructor(){super(...arguments),this.cellSize=64}render(){return s(p||(p=l` <div class="top-bar"> <div class="player" style="background-image:url(assets/ui/battle/player-${0}.png)"> Player ${0} </div> <div class="money"> <img src="assets/ui/battle/money.png" alt=""> <div class="value">${0}</div> </div> <img class="menu" src="assets/ui/battle/menu.png" alt="" @click="${0}"> </div> <div class="container-1"> <div class="container-2"> <ae-battle-field></ae-battle-field> </div> </div> <ae-turn-end-button unitsLeft="25" disabled="${0}" @click="${0}"></ae-turn-end-button> <ae-unit-store></ae-unit-store> <ae-unit-info></ae-unit-info> <ae-new-turn></ae-new-turn> <ae-game-end></ae-game-end> <ae-story></ae-story> <ae-notification></ae-notification> <ae-conversation></ae-conversation> `),this.color,this.playerId,this.money,this.openMenu,!this.showEndTurnButton,this.endTurn)}updated(){this.field.scrollIntoView({block:"center"})}openMenu(){var e;const t=document.createElement("ae-battle-menu");t.round=this.round,t.showEndTurnButton=this.showEndTurnButton,null===(e=this.shadowRoot)||void 0===e||e.append(t)}centerToXY(e){this.container.scrollTo({top:e.y*this.field.cellSize-120,left:e.x*this.field.cellSize-120,behavior:"smooth"})}openNewTurnPopup(e){return new Promise((t=>{this.newTurn.open(e),this.newTurn.addEventListener("new-turn-close",(()=>t()))}))}openStory(e){return new Promise((t=>{this.story.open(e),this.story.addEventListener("story-next",(()=>t()))}))}openNotification(e){return new Promise((t=>{this.notification.open(e),this.notification.addEventListener("notification-close",(()=>t()))}))}openConversation(e){return new Promise((t=>{this.conversation.open(e),this.conversation.addEventListener("conversation-close",(()=>t()))}))}openGameEnd(e){return new Promise((t=>{this.gameEnd.open(e),this.gameEnd.addEventListener("game-end-close",(()=>t()))}))}openPopup(e,t){if("story"===e)return this.openStory(t);if("briefing"===e)return this.openConversation(t);if("simple-notification"===e)return this.openNotification(t);if("win-or-defeat"===e)return this.openGameEnd(t);throw new Error("Unknown popup type")}openSaveDialog(e){var t;const o=document.createElement("ae-dialog");o.type="save";const n=document.createElement("ae-save-battle");n.name=e,n.addEventListener("save-submit",(()=>o.close())),n.addEventListener("save-cancel",(()=>o.close())),o.append(n),null===(t=this.shadowRoot)||void 0===t||t.append(o)}zoomToFit(){this.field.fitSize(),this.preventAnimations()}zoomIn(){this.field.cellSize+=8,this.preventAnimations()}zoomOut(){this.field.cellSize-=8,this.preventAnimations()}preventAnimations(){this.classList.add("stop-animations"),setTimeout((()=>this.classList.remove("stop-animations")),50)}endTurn(){this.dispatchEvent(e("end-turn"))}};c.styles=t(d||(d=l`:host{display:grid;grid-template-rows:auto 1fr auto;position:fixed;top:0;left:0;width:100%;height:100%;background:#242a45}.top-bar{background:#5a3019;height:60px;position:relative;z-index:1}.player{width:111px;height:40px;position:absolute;top:10px;left:0;display:flex;align-items:center;padding:0 10px;box-sizing:border-box;font-family:Changa;font-style:normal;font-weight:800;font-size:16px;line-height:29px;text-align:center;color:#fffbde}.money{position:absolute;width:120px;height:78px;top:0;left:calc(50% - 60px);background-image:url(assets/ui/battle/money-box.png);display:flex;flex-direction:column;align-items:center;font-family:Changa;font-style:normal;font-weight:800;font-size:18px;line-height:33px;color:#4a2210}.money img{margin-right:3px}.money .value{margin-top:-10px}.top-bar .menu{position:absolute;right:20px;top:15px;cursor:pointer}ae-turn-end-button{position:absolute;bottom:10px;right:20px;z-index:1}.container-1{width:100%;height:100%;overflow:auto;display:grid;grid-template-rows:minmax(50px,1fr) auto minmax(100px,1fr)}.container-1::after,.container-1::before{content:''}.container-2{display:grid;grid-template-columns:minmax(50px,1fr) auto minmax(50px,1fr)}.container-2::after,.container-2::before{content:''}`)),o([n({type:Number})],c.prototype,"playerId",void 0),o([n({type:Number})],c.prototype,"money",void 0),o([n({type:String})],c.prototype,"color",void 0),o([n({type:Number})],c.prototype,"round",void 0),o([n({type:Number})],c.prototype,"cellSize",void 0),o([n({type:Boolean})],c.prototype,"showEndTurnButton",void 0),o([i(".container-1")],c.prototype,"container",void 0),o([i("ae-battle-field")],c.prototype,"field",void 0),o([i("ae-unit-store")],c.prototype,"unitStore",void 0),o([i("ae-unit-info")],c.prototype,"unitInfo",void 0),o([i("ae-save-battle")],c.prototype,"save",void 0),o([i("ae-new-turn")],c.prototype,"newTurn",void 0),o([i("ae-game-end")],c.prototype,"gameEnd",void 0),o([i("ae-story")],c.prototype,"story",void 0),o([i("ae-notification")],c.prototype,"notification",void 0),o([i("ae-conversation")],c.prototype,"conversation",void 0),c=o([a("ae-battle")],c);
