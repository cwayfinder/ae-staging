import{d as t}from"./fbfb0d48.js";import{B as i}from"./dbbb96b8.js";window.ai=new class{constructor(t,i,e,n,r,s){this.scenarioCollector=t,this.rating=i,this.shopping=e,this.repo=n,this.apiService=r,this.eventService=s}async run(t){this.playerId=t,this.shopping.buyUnits(t),await this.turnUnit()}async turnUnit(){if(this.repo.getBattle().ended)return;const t=this.getBestScenario(this.playerId);t?await this.runScenario(t):this.apiService.endTurn()}async runScenario(e){this.eventService.emitEvent(new i("view","center",e.origin)),await t(300),await this.runActions(e.unit,e.actions)}async runActions(t,i){for(const e of i)this.apiService.executeUnitAction(t,e);await this.turnUnit()}getBestScenario(t){const i=this.scenarioCollector.collect(t);if(i.length){this.rating.rate(i);return i.sort(((t,i)=>i.rate-t.rate))[0]}return null}}(window.scenarioCollector,window.rating,window.shopping,window.battleRepository,window.apiService,window.eventService);
