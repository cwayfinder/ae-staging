import{c as t,_ as e,p as i,q as n,a,L as o,h as s}from"./f0da52c9.js";let r,u,d=t=>t,l=class extends o{constructor(){super(...arguments),this.effects=[],this._animationDuration=200}get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=t,this.updateComplete.then((()=>{this.imageEl.style.transition=`background ${t}ms ease-out`,this.imageEl.style.animationDuration="600ms",setTimeout((()=>this.style.transition=`transform ${this.animationDuration}ms ease-out`))}))}render(){return s(r||(r=d` <div class="unit-image">&nbsp;</div> <div class="unit-health-one">&nbsp;</div> <div class="unit-health-ten">&nbsp;</div> <div class="unit-level">&nbsp;</div> <div class="under-poison-image">&nbsp;</div> <div class="under-wisp-aura-image">&nbsp;</div> `))}firstUpdated(t){this.runShowAnimation()}runShowAnimation(){this.imageEl.addEventListener("animationend",(()=>{this.imageEl.classList.remove("show-new-unit")})),this.imageEl.classList.add("show-new-unit")}runHealthChangeAnimation(t){return new Promise((e=>{var i;const n=document.createElement("ae-unit-health-diff");n.value=t,n.style.animationDuration=1.5*this.animationDuration+"ms",null===(i=this.shadowRoot)||void 0===i||i.append(n),n.addEventListener("animationend",(()=>{n.remove(),e()}),{once:!0}),n.classList.add("bounce")}))}runLevelUpAnimation(){var t;const e=document.createElement("div");e.className="unit-level-up",e.style.animationDuration=this.animationDuration+"ms",null===(t=this.shadowRoot)||void 0===t||t.append(e),e.addEventListener("animationend",(()=>{e.remove()}),{once:!0}),e.classList.add("move-up")}async move(t){this.cell=t}updated(t){this._translate(this.cell);const e=this.active?this.color:"gray",i="saeth-heavens-fury"===this.type?"saeth":this.type;this.imageEl.style.backgroundImage=`url(assets/images/unit/unit-${i}-${e}.png)`,this.updateHealth(),this.updateLevel(),this.updatePoisoned(),this.updateUnderWispAura()}_translate({x:t,y:e}){this.style.setProperty("transform",`translate(calc(${t} * var(--squareSize)), calc(${e} * var(--squareSize)))`)}updateHealth(){if(!this.shadowRoot)return;const t=this.shadowRoot.querySelector(".unit-health-one"),e=this.shadowRoot.querySelector(".unit-health-ten");if(this.health===this.defaultHealth)t.hidden=!0,e.hidden=!0;else{const i=this.health.toString().split("");let n="none",a="none";n=i.pop()||n,a=i.pop()||a,"none"===n?t.hidden=!0:(t.hidden=!1,t.style.backgroundImage=`url(assets/images/fonts/numbers-1-${n}.png)`),"none"===a?e.hidden=!0:(e.hidden=!1,e.style.backgroundImage=`url(assets/images/fonts/numbers-1-${a}.png)`)}}updateLevel(){if(!this.shadowRoot)return;const t=this.shadowRoot.querySelector(".unit-level");this.level?(t.hidden=!1,t.style.backgroundImage=`url(assets/images/fonts/numbers-1-${this.level}.png)`):t.hidden=!0}updatePoisoned(){if(!this.shadowRoot)return;this.shadowRoot.querySelector(".under-poison-image").hidden=!this.effects.includes("poisoned")}updateUnderWispAura(){if(!this.shadowRoot)return;this.shadowRoot.querySelector(".under-wisp-aura-image").hidden=!this.effects.includes("inspired")}};l.styles=t(u||(u=d`:host{display:block;position:absolute;left:0;top:0;background-size:100% 100%;background-repeat:no-repeat;z-index:1;width:var(--squareSize);height:var(--squareSize)}:host(.moving){z-index:1}.unit-image{width:100%;height:100%;background-size:100% auto;background-repeat:no-repeat;position:absolute;z-index:0;transition:background .2s linear;animation-duration:.6s;animation-name:unit-bg-shift;animation-iteration-count:infinite;animation-direction:normal;animation-timing-function:steps(2);animation-fill-mode:forwards}.unit-image.show-new-unit{animation-name:unit-appear;animation-iteration-count:1;animation-direction:normal;animation-timing-function:linear;animation-fill-mode:forwards;transform-origin:50% 100%}@keyframes unit-appear{0%{transform:scale(1,0)}100%{transform:scale(1,1)}}@keyframes unit-bg-shift{from{background-position:0 0}to{background-position:0 200%}}.delta-unit-health{position:absolute;z-index:2;left:0;top:0;width:100%;height:100%}.unit-health-one,.unit-health-ten{background-repeat:no-repeat;background-size:100% 100%;width:25%;height:33.666666%;position:absolute;bottom:0;z-index:1}.unit-health-ten{left:0}.unit-health-one{left:25%}.delta-unit-health-one,.delta-unit-health-sign,.delta-unit-health-ten{background-repeat:no-repeat;background-size:100% 100%;width:33.333333%;height:50%;float:left;margin-top:50%}.unit-level{background-repeat:no-repeat;background-size:100% 100%;width:25%;height:33.666666%;position:absolute;right:12.5%;bottom:0}.bounce{animation-duration:.6s;animation-iteration-count:1;animation-name:bounce;animation-fill-mode:forwards;transform-origin:center bottom}@keyframes bounce{0%,100%,20%,53%,80%{transform:translate3d(0,0,0)}40%,43%{transform:translate3d(0,-50%,0)}70%{transform:translate3d(0,-40%,0)}90%{transform:translate3d(0,0,0)}}.under-poison-image,.under-wisp-aura-image{width:33.333333%;background-size:100% 100%;background-repeat:no-repeat;position:relative;z-index:1;float:right}.under-wisp-aura-image{background-image:url(assets/images/unit/under-wisp-aura.png);height:33.333333%}.under-poison-image{background-image:url(assets/images/unit/under-poison.png);height:50%}.unit-level-up{background-repeat:no-repeat;background-size:100% 100%;width:300%;left:-100%;position:absolute;bottom:0;height:50%;background-image:url(assets/images/ux/level-up.png)}.unit-level-up.move-up{animation-duration:.6s;animation-iteration-count:1;animation-name:level-up;animation-fill-mode:forwards;transform-origin:center center}@keyframes level-up{0%{transform:translate3d(0,0,0)}100%{transform:translate3d(0,-200%,0)}}.hide-unit-animation .unit-image{animation:none}:host-context(.stop-animations){transition:none!important}`)),e([i({type:Number,reflect:!0,attribute:"data-unit-id"})],l.prototype,"unitId",void 0),e([i({type:Object})],l.prototype,"cell",void 0),e([i({type:String,reflect:!0,attribute:"data-type"})],l.prototype,"type",void 0),e([i({type:String})],l.prototype,"color",void 0),e([i({type:Boolean})],l.prototype,"active",void 0),e([i({type:Number})],l.prototype,"health",void 0),e([i({type:Number})],l.prototype,"defaultHealth",void 0),e([i({type:Number,reflect:!0,attribute:"data-level"})],l.prototype,"level",void 0),e([i({type:Array})],l.prototype,"effects",void 0),e([i({type:Number})],l.prototype,"animationDuration",null),e([n(".unit-image")],l.prototype,"imageEl",void 0),l=e([a("ae-unit")],l);
